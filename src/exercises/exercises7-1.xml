<?xml version="1.0" encoding="UTF-8"?>

<exercises>

  <exercise>
    <statement>
      <p>
	For each of the following matrices, find the eigenvalues and a
	basis for each eigenspace.  Determine whether the matrix is
	diagonalizable and, if so, find a diagonalization.  Determine
	whether the matrix is orthogonally diagonalizable and, if so,
	find an orthogonal diagonalization.
	<sage>
	  <input>

	  </input>
	</sage>

	<ol label="a.">
	  <li>
	    <p>
	      <m>\begin{bmatrix}
	      5 \amp 1 \\
	      -1 \amp 3 \\
	      \end{bmatrix}
	      </m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>
		\begin{bmatrix}
		0 \amp 1  \\
		1 \amp 0 \\
		\end{bmatrix}
	      </m>
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>
		\begin{bmatrix}
		1 \amp 0 \amp 0 \\
		2 \amp -2 \amp 0 \\
		0 \amp 1 \amp 4 \\
		\end{bmatrix}
	      </m>
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>
		\begin{bmatrix}
		2 \amp 5 \amp -4\\
		5 \amp -7 \amp 5 \\
		-4 \amp 5 \amp 2 \\
		\end{bmatrix}
	      </m>
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Consider the matrix 
	<m>
	  A = 
	  \begin{bmatrix}
	  1 \amp 2 \amp 2 \\
	  2 \amp 1 \amp 2 \\
	  2 \amp 2 \amp 1 \\
	  \end{bmatrix}
	</m>
	The eigenvalues of <m>A</m> are <m>\lambda_1=5</m>,
	<m>\lambda_2=-1</m>, and <m>\lambda_3 = -1</m>.
	<sage>
	  <input>

	  </input>
	</sage>
	<ol label="a.">
	  <li>
	    <p>
	      Explain why <m>A</m> is orthogonally diagonalizable.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find an orthonormal basis for the eigenspace <m>E_5</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find a basis for the eigenspace <m>E_{-1}</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Now find an orthonormal basis for <m>E_{-1}</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find matrices <m>D</m> and <m>Q</m> such that
	      <m>A=QDQ^T</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Find an orthogonal diagonalization, if one exists, for the
	following matrices.
	<sage>
	  <input>

	  </input>
	</sage>
	<ol label="a.">
	  <li>
	    <p>
	      <m>
		\begin{bmatrix}
		11 \amp 4 \amp 12 \\
		4 \amp -3 \amp -16 \\
		12 \amp -16 \amp 1
		\end{bmatrix}
	      </m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>
		\begin{bmatrix}
		1 \amp 0 \amp 2 \\
		0 \amp 1 \amp 2 \\
		-2 \amp -2 \amp 1 \\
		\end{bmatrix}
	      </m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>
		\begin{bmatrix}
		9 \amp 3 \amp 3 \amp 3\\
		3 \amp 9 \amp 3 \amp 3\\
		3 \amp 3 \amp 9 \amp 3\\
		3 \amp 3 \amp 3 \amp 9\\
		\end{bmatrix}
		</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose that <m>A</m> is an <m>m\times n</m> matrix and that
	<m>B=A^TA</m>.
	<ol label="a.">
	  <li>
	    <p>
	      Explain why <m>B</m> is orthogonally diagonalizable.
	    </p>
	  </li>
	  <li>
	    <p>
	      Explain why <m>\vvec\cdot(B\vvec) = \len{A\vvec}^2</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Suppose that <m>\uvec</m> is an eigenvector of <m>B</m>
	      with associated eigenvalue <m>\lambda</m> and that
	      <m>\uvec</m> has unit length.  Explain why <m>\lambda =
	      \len{A\uvec}^2</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Explain why the eigenvalues of <m>B</m> are nonnegative.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>C</m> is the covariance matrix associated to a
	      demeaned data set, explain why the eigenvalues of
	      <m>C</m> are nonnegative.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose that you have the data points
	<me>
	  (2,0), (2,3), (4,1), (3,2), (4,4).
	</me>
	<ol label="a.">
	  <li>
	    <p>
	      Find the demeaned data points.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find the total variance <m>V</m> of the data set.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find the variance in the direction <m>\evec_1 =
	      \twovec10</m> 
	      and the 
	      variance in the direction <m>\evec_2=\twovec01</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Project the demeaned data points onto the line defined
	      by <m>\vvec_1=\twovec21</m> and find the variance of
	      these projected points.
	    </p>
	  </li>
	  <li>
	    <p>
	      Project the demeaned data points onto the line defined by
	      <m>\vvec_2=\twovec1{-2}</m> and find the variance of
	      these projected points.
	    </p>
	  </li>
	  <li>
	    <p>
	      How and why are the results of from the last two parts
	      related to the total variance?
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose you have six 2-dimensional data points arranged in the
	matrix
	<me>
	  \begin{bmatrix}
	  2 \amp 0 \amp 4 \amp 4 \amp 5 \amp 3 \\
	  1 \amp 0 \amp 3 \amp 5 \amp 4 \amp 5
	  \end{bmatrix}.
	</me>
	<ol label="a.">
	  <li>
	    <p>
	      Find the matrix <m>A</m> of demeaned data points and
	      plot the points in <xref ref="ex-demean-plot"/>.
	      <figure xml:id="ex-demean-plot">
		<sidebyside width="50%">
		  <image source="images/empty-4" />
		</sidebyside>
		<caption>
		  A plot for the demeaned data points.
		</caption>
	      </figure>
	    </p>
	  </li>
	  <li>
	    <p>
	      Construct the covariance matrix <m>C</m> and explain why
	      you know that it is orthogonally diagonalizable.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find an orthogonal diagonalization of <m>C</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Sketch the lines corresponding to the two eigenvectors
	      on the plot above.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find the variances in the directions of the
	      eigenvectors.  
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>


  <exercise>
    <statement>
      <p>
	Suppose that <m>C</m> is the covariance matrix of a demeaned
	data set.
	<ol label="a.">
	  <li>
	    <p>
	      Suppose that <m>\uvec</m> is an eigenvector of <m>C</m>
	      with associated 
	      eigenvalue <m>\lambda</m> and that <m>\uvec</m> has unit
	      length.  Explain why <m>V_{\uvec} = \lambda</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Suppose that the covariance matrix of a demeaned data set can
	      be written as <m>C=QDQ^T</m> where
	      <me>
		Q = \begin{bmatrix} \uvec_1 \amp \uvec_2 \end{bmatrix},
		\hspace{24pt}
		D = \begin{bmatrix}
		10 \amp 0 \\
		0 \amp 0 \\
		\end{bmatrix}.
	      </me>
	      What is <m>V_{\uvec_2}</m>?  What does this tell you
	      about the demeaned data?
	    </p>
	  </li>
	  <li>
	    <p>
	      Explain why the total variance of a data set equals the
	      sum of the eigenvalues of the covariance matrix.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Determine whether the following statements are true or false
	and explain your thinking.
	<ol label="a.">
	  <li>
	    <p>
	      If <m>A</m> is an invertible, orthogonally
	      diagonalizable matrix, then so is <m>A^{-1}</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>\lambda=2+i</m> is an eigenvalue of <m>A</m>, then
	      <m>A</m> cannot be orthogonally diagonalizable.
	    </p>
	  </li>
	  <li>
	    <p>
	      If there is a basis for <m>\real^n</m> consisting of
	      eigenvectors of <m>A</m>, then <m>A</m> is orthogonally
	      diagonalizable.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>\uvec</m> and <m>\vvec</m> are eigenvectors of a
	      symmetric matrix associated to eigenvalues -2 and 3,
	      then <m>\uvec\cdot\vvec=0</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A</m> is a square matrix, then
	      <m>\uvec\cdot(A\vvec) = (A\uvec)\cdot\vvec</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose that <m>A</m> is a noninvertible, symmetric
	<m>3\times3</m> matrix having eigenvectors
	<me>
	  \uvec_1 = \threevec2{-1}2,\hspace{24pt}
	  \uvec_2 = \threevec141
	</me>
	and associated eigenvalues <m>\lambda_1 = 20</m> and
	<m>\lambda_2 = -4</m>. 
	Find matrices <m>Q</m> and <m>D</m> such that <m>A =
	QDQ^T</m>. 
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose that <m>W</m> is a plane in <m>\real^3</m> and that
	<m>P</m> is the <m>3\times3</m> matrix that projects vectors
	orthogonally onto <m>W</m>.
	<ol label="a.">
	  <li>
	    <p>
	      Explain why <m>P</m> is orthogonally
	      diagonalizable.
	    </p>
	  </li>
	  <li>
	    <p>
	      What are the eigenvalues of <m>P</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      Explain the relationship between the eigenvectors of
	      <m>P</m> and the plane <m>W</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>
	    
</exercises>

