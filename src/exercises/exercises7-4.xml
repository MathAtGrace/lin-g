<?xml version="1.0" encoding="UTF-8"?>

<exercises>

  <exercise xml:id="ex-7-4-1">
    <statement>
      <p>
	Consider the matrix
	<m>
	  A = \begin{bmatrix}
	  1 \amp 2 \amp 1 \\
	  0 \amp -1 \amp 2 \\
	  \end{bmatrix}
	</m>.
	<sage>
	  <input>
	  </input>
	</sage>
	<ol label="a.">
	  <li>
	    <p> Find the Gram matrix <m>G=A^TA</m> and use it to find
	    the singular values and right singular vectors of
	    <m>A</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find the left singular vectors.
	    </p>
	  </li>
	  <li>
	    <p>
	      Form the matrices <m>U</m>, <m>\Sigma</m>, and <m>V</m>
	      and verify that <m>A=U\Sigma V^T</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      What is <m>\rank(A)</m> and what does this say about
	      <m>\col(A)</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      Determine an orthonormal basis for <m>\nul(A)</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Find singular value decompositions for the following matrices:
	<ol label="a.">
	  <li>
	    <p>
	      <m>\begin{bmatrix} 0 \amp 0 \\ 0 \amp -8
	      \end{bmatrix}</m>.
	    </p>
	  </li>
	  <li>
	    <p>
e	      <m>\begin{bmatrix} 2 \amp 3 \\ 0 \amp 2
	      \end{bmatrix}</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>\begin{bmatrix}
	      4 \amp 0 \amp 0 \\
	      0 \amp 0 \amp 2
	      \end{bmatrix}
	      </m>
	    </p>
	  </li>
	  <li>
	    <p>
	      <m>\begin{bmatrix}
	      4 \amp 0 \\
	      0 \amp 0 \\
	      0 \amp 2 
	      \end{bmatrix}
	      </m>
	    </p>
	  </li>
	</ol>
	      
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Consider the matrix
	<m>
	  A = \begin{bmatrix}
	  2 \amp 1 \\
	  1 \amp 2
	  \end{bmatrix}
	</m>.
	<ol label="a.">
	  <li>
	    <p>
	      Find a singular value decomposition of <m>A</m> and
	      verify that it is also an orthogonal
	      diagonalization of <m>A</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A</m> is a symmetric, positive definite matrix,
	      explain why a singular value decomposition of <m>A</m>
	      is an orthogonal diagonalization of <m>A</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose that the matrix <m>A</m> has the singular value
	decomposition
	<me>
	  \begin{bmatrix}
	  -0.46 \amp 0.52 \amp 0.46 \amp 0.55 \\
	  -0.82 \amp -0.00 \amp -0.14 \amp -0.55 \\
	  -0.04 \amp 0.44 \amp -0.85 \amp 0.28 \\
	  -0.34 \amp -0.73 \amp -0.18 \amp 0.55
	  \end{bmatrix}
	  \begin{bmatrix}
	  6.2 \amp 0.0 \amp 0.0 \\
	  0.0 \amp 4.1 \amp 0.0 \\
	  0.0 \amp 0.0 \amp 0.0 \\
	  0.0 \amp 0.0 \amp 0.0
	  \end{bmatrix}
	  \begin{bmatrix}
	  -0.74 \amp 0.62 \amp -0.24 \\
	  0.28 \amp 0.62 \amp 0.73 \\
	  -0.61 \amp -0.48 \amp 0.64
	  \end{bmatrix}.
	</me>
	<ol label="a.">
	  <li>
	    <p>
	      What is the shape of <m>A</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      What is <m>\rank(A)</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      Find orthonormal bases for <m>\col(A)</m>,
	      <m>\nul(A)</m>, <m>\col(A^T)</m>, and <m>\nul(A^T)</m>. 
	    </p>
	  </li>
	  <li>
	    <p>
	      Find the orthogonal projection of
	      <m>\bvec=\fourvec102{-1}</m> onto <m>\col(A)</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Consider the matrix
	<m>A = \begin{bmatrix}
	1 \amp 0 \amp -1 \\
	2 \amp 2 \amp 0 \\
	-1 \amp 1 \amp 2\\
	\end{bmatrix}
	</m>.
	<sage>
	  <input>
	  </input>
	</sage>
	<ol label="a.">
	  <li>
	    <p>
	      Construct the Gram matrix <m>G</m> and use it to find
	      the singular values and right singular vectors
	      <m>\vvec_1</m>, <m>\vvec_2</m>, and <m>\vvec_3</m> of
	      <m>A</m>.  What are the matrices <m>\Sigma</m> and
	      <m>V</m> in a singular value decomposition?
	    </p>
	  </li>
	  <li>
	    <p>
	      What is <m>\rank(A)</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      Find as many left singular <m>\uvec_j</m> as you can
	      using the relationship <m>A\vvec_j=\sigma_j\uvec_j</m>. 
	    </p>
	  </li>
	  <li>
	    <p>
	      Find an orthonormal basis for <m>\nul(A^T)</m> and use
	      it to construct the matrix <m>U</m> so that <m>A=U\Sigma
	      V^T</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      State an orthonormal basis for <m>\nul(A)</m> and an
	      orthonormal basis for <m>\col(A)</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>
	
  <exercise>
    <statement>
      <p>
	Consider the matrix
	<m>B=\begin{bmatrix}
	1 \amp 0 \\
	2 \amp -1 \\
	1 \amp 2
	\end{bmatrix}</m> and notice that <m>B=A^T</m> where <m>A</m>
	is the matrix in <xref ref="ex-7-4-1"/>.
	<sage>
	  <input>
	  </input>
	</sage>
	<ol label="a.">
	  <li>
	    <p>
	      Use your result from <xref ref="ex-7-4-1"/> to find a
	      singular value decomposition of <m>B=U\Sigma V^T</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      What is <m>\rank(B)</m>?  Determine a basis for
	      <m>\col(B)</m> and <m>\col(B)^\perp</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Suppose that <m>\bvec=\threevec{-3}47</m>.  Use the
	      bases you found in the previous part of this exericse to
	      write <m>\bvec=\bhat+\bvec^\perp</m>, 
	      where <m>\bhat</m> is in <m>\col(B)</m> and
	      <m>\bvec^\perp</m> is in <m>\col(B)^\perp</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      Find the least squares approximate solution to the
	      equation <m>B\xvec=\bvec</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	Suppose that <m>A</m> is a square <m>n\times n</m> matrix with
	singular value decomposition <m>A=U\Sigma V^T</m>.
	<ol label="a.">
	  <li>
	    <p>
	      If <m>A</m> is invertible, find a singular value
	      decomposition of <m>A^{-1}</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      What condition on the singular values must hold for
	      <m>A</m> to be invertible?
	    </p>
	  </li>
	  <li>
	    <p>
	      How are the singular values of <m>A</m> and the singular
	      values of <m>A^{-1}</m> related to one another?
	    </p>
	  </li>
	  <li>
	    <p>
	      How are the right and left singular vectors of <m>A</m>
	      related to the right and left
	      singular vectors of <m>A^{-1}</m>?
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	<ol label="a.">
	  <li>
	    <p>
	      If <m>Q</m> is an orthogonal matrix, remember that
	      <m>Q^TQ=I</m>.  Explain why <m>\det Q = \pm 1</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A=U\Sigma V^T</m> is a singular value
	      decomposition of a square matrix <m>A</m>, explain why
	      <m>|\det A|</m> is the product of the singular values of
	      <m>A</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      What does this say about the singular values of <m>A</m>
	      if <m>A</m> is invertible?
	    </p>
	  </li>
	</ol>

      </p>
    </statement>
  </exercise>

  <exercise>
    <statement>
      <p>
	If <m>A</m> is a matrix and <m>G=A^TA</m> its Gram matrix,
	remember that
	<me>
	  \xvec\cdot(G\xvec) = 
	  \xvec\cdot(A^TA\xvec) =
	  (A\xvec)\cdot(A\xvec) = \len{A\xvec}^2.
	</me>
	<ol label="a.">
	  <li>
	    <p>
	      For a general matrix <m>A</m>, explain why the eigenvalues
	      of <m>G</m> are nonnegative. 
	    </p>
	  </li>
	  <li>
	    <p>
	      Given a symmetric matrix <m>A</m> having an eigenvalue
	      <m>\lambda</m>, explain why <m>\lambda^2</m> is an
	      eigenvalue of <m>G</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A</m> is symmetric, explain why the singular
	      values of <m>A</m> equal the absolute value of its
	      eigenvalues:  <m>\sigma_j = |\lambda_j|</m>.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>
	    
  <exercise>
    <statement>
      <p>
	Determine whether the following statements are true or false
	and explain your reasoning.
	<ol label="a.">
	  <li>
	    <p>
	      If <m>A=U\Sigma V^T</m> is a singular value
	      decomposition of <m>A</m>, then 
	      <m>G=V(\Sigma^T\Sigma)V^T</m> is an orthogonal
	      diagonalization of its Gram matrix.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A=U\Sigma V^T</m> is a singular value
	      decomposition of a rank 2 matrix <m>A</m>, then
	      <m>\vvec_1</m> and <m>\vvec_2</m> form an orthonormal
	      basis for the column space <m>\col(A)</m>.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A</m> is a diagonalizable matrix, then its set of 
	      singular values is the same as its set of eigenvalues.
	    </p>
	  </li>
	  <li>
	    <p>
	      If <m>A</m> is a <m>10\times7</m> matrix and <m>\sigma_7
	      = 4</m>, then the columns of <m>A</m> are linearly
	      independent. 
	    </p>
	  </li>
	  <li>
	    <p>
	      The Gram matrix is always orthogonally diagonalizable.
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>

<!--    
    Exercises:  shape of \sigma when A has linear dependent columns,
    span r^n, etc.

Why are eigenvalues of G positive
-->    
  
  <exercise>
    <statement>
      <p>
	Suppose that <m>A=U\Sigma V^T</m> is a singular value
	decomposition of the <m>m\times n</m> matrix <m>A</m>.  If
	<m>\sigma_1,\ldots,\sigma_r</m> 
	are the nonzero singular values,
	the general form of the matrix <m>\Sigma</m> is
	<me>
	  \Sigma = 
	  \begin{bmatrix}
	  \sigma_1 \amp \ldots \amp 0 \amp \ldots \amp 0 \\
	  0 \amp \ldots \amp 0 \amp \ldots \amp 0 \\
	  0 \amp \ldots \amp \sigma_r \amp \ldots \amp 0 \\
	  0 \amp \ldots \amp 0 \amp \ldots \amp 0 \\
	  0 \amp \vdots \amp 0 \amp \vdots \amp 0 \\
	  0 \amp \ldots \amp 0 \amp \ldots \amp 0 \\
	  \end{bmatrix}.
	</me>
	<ol label="a.">
	  <li>
	    <p>
	      If you know that the columns of <m>A</m> are linearly
	      independent, what more can you say about the form of
	      <m>\Sigma</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      If you know that the columns of <m>A</m> span
	      <m>\real^m</m>, what more can you say about the form of
	      <m>\Sigma</m>?
	    </p>
	  </li>
	  <li>
	    <p>
	      If you know that the columns of <m>A</m> are linearly
	      independent and span <m>\real^m</m>, what more can you
	      say about the form of <m>\Sigma</m>?
	    </p>
	  </li>
	</ol>
      </p>
    </statement>
  </exercise>
  
</exercises>

